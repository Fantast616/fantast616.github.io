<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"blog.fantast.top","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.9.0","exturl":false,"sidebar":{"position":"left","width":250,"display":"always","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":true,"color":"#222","save":"manual"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"utterances","storage":true,"lazyload":false,"nav":null,"activeClass":"utterances"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>
<meta name="description" content="计网微课堂Chap4——网络层原理">
<meta property="og:type" content="article">
<meta property="og:title" content="计网微课堂Chap4——网络层原理">
<meta property="og:url" content="https://blog.fantast.top/2022/07/12/a63746099b02/index.html">
<meta property="og:site_name" content="Fantast&#39;s Blog">
<meta property="og:description" content="计网微课堂Chap4——网络层原理">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14 下午1.10.50.png">
<meta property="og:image" content="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14 下午1.26.26.png">
<meta property="og:image" content="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14 下午2.14.21.png">
<meta property="og:image" content="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14 下午2.48.32.png">
<meta property="og:image" content="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14 下午3.08.12.png">
<meta property="og:image" content="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14 下午5.02.09.png">
<meta property="og:image" content="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14 下午5.14.34.png">
<meta property="og:image" content="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14 下午5.21.54.png">
<meta property="og:image" content="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715135934147.png">
<meta property="og:image" content="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715140223941.png">
<meta property="og:image" content="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715140524648.png">
<meta property="og:image" content="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715140751946.png">
<meta property="og:image" content="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715141716322.png">
<meta property="og:image" content="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715143347153.png">
<meta property="og:image" content="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715151418051.png">
<meta property="article:published_time" content="2022-07-12T06:33:19.000Z">
<meta property="article:modified_time" content="2022-08-07T14:51:07.000Z">
<meta property="article:author" content="Fantast">
<meta property="article:tag" content="Computer Network">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14 下午1.10.50.png">


<link rel="canonical" href="https://blog.fantast.top/2022/07/12/a63746099b02/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://blog.fantast.top/2022/07/12/a63746099b02/","path":"2022/07/12/a63746099b02/","title":"计网微课堂Chap4——网络层原理"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>计网微课堂Chap4——网络层原理 | Fantast's Blog</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="Fantast's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Fantast's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E7%BD%91%E7%BB%9C%E5%B1%82%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="nav-text">一、网络层的基本概念：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E7%BD%91%E7%BB%9C%E5%B1%82%E6%8F%90%E4%BE%9B%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%9C%8D%E5%8A%A1"><span class="nav-text">二、网络层提供的两种服务</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%89ipv4%E5%9C%B0%E5%9D%80"><span class="nav-text">三、IPV4地址</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9B%9B%E5%88%86%E7%B1%BB%E7%BC%96%E5%9D%80%E7%9A%84ipv4%E5%9C%B0%E5%9D%80"><span class="nav-text">四、分类编址的IPV4地址：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%94%E5%88%92%E5%88%86%E5%AD%90%E7%BD%91%E7%9A%84ipv4%E5%9C%B0%E5%9D%80"><span class="nav-text">五、划分子网的IPV4地址：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%AD%E6%97%A0%E5%88%86%E7%B1%BB%E7%BC%96%E5%9D%80%E7%9A%84ipv4%E5%9C%B0%E5%9D%80"><span class="nav-text">六、无分类编址的IPV4地址：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%83%E5%88%86%E9%85%8Dipv4%E5%9C%B0%E5%9D%80%E7%9A%84%E5%BA%94%E7%94%A8%E8%A7%84%E5%88%92"><span class="nav-text">七、分配IPV4地址的应用规划</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%ABip%E6%95%B0%E6%8D%AE%E5%8C%85%E7%9A%84%E5%8F%91%E9%80%81%E4%B8%8E%E8%BD%AC%E5%8F%91"><span class="nav-text">八、IP数据包的发送与转发</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%BA%90%E4%B8%BB%E6%9C%BA%E5%A6%82%E4%BD%95%E7%9F%A5%E9%81%93%E8%87%AA%E5%B7%B1%E4%B8%8E%E7%9B%AE%E7%9A%84%E4%B8%BB%E6%9C%BA%E4%B8%8D%E5%9C%A8%E5%90%8C%E4%B8%80%E4%B8%AA%E7%BD%91%E7%BB%9C%E4%B8%8B"><span class="nav-text">1、源主机如何知道自己与目的主机不在同一个网络下？</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%BA%90%E4%B8%BB%E6%9C%BA%E5%A6%82%E4%BD%95%E7%9F%A5%E9%81%93%E8%B7%AF%E7%94%B1%E5%99%A8r%E7%9A%84%E5%AD%98%E5%9C%A8"><span class="nav-text">2、源主机如何知道路由器R的存在？</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%B7%AF%E7%94%B1%E5%99%A8%E6%94%B6%E5%88%B0ip%E6%95%B0%E6%8D%AE%E6%8A%A5%E5%90%8E%E5%A6%82%E4%BD%95%E8%BD%AC%E5%8F%91"><span class="nav-text">3、路由器收到IP数据报后如何转发？</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%B7%AF%E7%94%B1%E8%A1%A8"><span class="nav-text">4、路由表：</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B9%9D%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE%E5%92%8C%E5%8F%AF%E8%83%BD%E4%BA%A7%E7%94%9F%E7%9A%84%E8%B7%AF%E7%94%B1%E7%8E%AF%E8%B7%AF%E9%97%AE%E9%A2%98"><span class="nav-text">九、静态路由配置和可能产生的路由环路问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%81%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE%E8%B7%AF%E7%94%B1%E9%80%89%E6%8B%A9%E5%8D%8F%E8%AE%AE%E6%A6%82%E8%BF%B0"><span class="nav-text">十、动态路由配置——路由选择协议概述：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%81%E4%B8%80%E8%B7%AF%E7%94%B1%E4%BF%A1%E6%81%AF%E5%8D%8F%E8%AE%AErip"><span class="nav-text">十一、路由信息协议RIP：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%81%E4%BA%8C%E5%BC%80%E6%94%BE%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84%E4%BC%98%E5%85%88ospf%E5%8D%8F%E8%AE%AE"><span class="nav-text">十二、开放最短路径优先OSPF协议：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%81%E4%B8%89%E8%BE%B9%E7%95%8C%E7%BD%91%E5%85%B3%E5%8D%8F%E8%AE%AEbgp"><span class="nav-text">十三、边界网关协议BGP：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%81%E5%9B%9Bip%E6%95%B0%E6%8D%AE%E5%8C%85%E7%9A%84%E9%A6%96%E9%83%A8%E6%A0%BC%E5%BC%8F"><span class="nav-text">十四、IP数据包的首部格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%81%E4%BA%94%E7%BD%91%E9%99%85%E6%8E%A7%E5%88%B6%E6%8A%A5%E6%96%87%E5%8D%8F%E8%AE%AEicmp"><span class="nav-text">十五、网际控制报文协议ICMP</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%81%E5%85%AD%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E7%BD%91vpn"><span class="nav-text">十六、虚拟专用网VPN</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%81%E4%B8%83%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2nat"><span class="nav-text">十七、网络地址转换NAT</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Fantast"
      src="/images/avatar.webp">
  <p class="site-author-name" itemprop="name">Fantast</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">167</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">42</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">98</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/fantast416" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;fantast416" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:fantast416@gmail.com" title="E-Mail → mailto:fantast416@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>


  <div class="links-of-blogroll site-overview-item animated">
    <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.zhihu.com/people/shuo-shuo-3-41" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;shuo-shuo-3-41" rel="noopener" target="_blank">ZhiHu</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.next.zju.edu.cn/" title="http:&#x2F;&#x2F;www.next.zju.edu.cn&#x2F;" rel="noopener" target="_blank">NextLab</a>
        </li>
    </ul>
  </div>
        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.fantast.top/2022/07/12/a63746099b02/">
    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.webp">
      <meta itemprop="name" content="Fantast">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fantast's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          计网微课堂Chap4——网络层原理
        </h1>

        <div class="post-meta-container">
          
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-07-12 14:33:19" itemprop="dateCreated datePublished" datetime="2022-07-12T14:33:19+08:00">2022-07-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-08-07 22:51:07" itemprop="dateModified" datetime="2022-08-07T22:51:07+08:00">2022-08-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E2%93%B9-%E5%9F%BA%E7%A1%80%E7%B1%BB%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">⓹ 基础类笔记</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E2%93%B9-%E5%9F%BA%E7%A1%80%E7%B1%BB%E7%AC%94%E8%AE%B0/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" itemprop="url" rel="index"><span itemprop="name">计算机网络</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>6.8k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>19 分钟</span>
    </span>
</div>

            <div class="post-description">计网微课堂Chap4——网络层原理</div>
            <div class="post-remind">Google Chrome is recommended, otherwise the image size may be wrong</div>
            <div class="post-remind">FireFox is not recommended,Because it does not support the image zoom property</div>
        </div>
        
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>视频地址：https://www.bilibili.com/video/BV1c4411d7jb?p=41</p>
<h4 id="一网络层的基本概念">一、网络层的基本概念：</h4>
<p>​
网络层的主要任务是实现网络互连，进而实现数据包在各网络之间的传输。</p>
<p>​ 要实现网络层任务，需要解决以下主要问题：</p>
<ul>
<li><p>网络层向运输层提供怎样的服务（“可靠传输”还是“不可靠传输"）</p></li>
<li><p>网络层寻址问题</p></li>
<li><p>路由选择问题</p></li>
</ul>
<p><strong>因特网（Internet）是目前全世界用户数量最多的互联网，它使用TCP/IP协议栈。由于TCP/IP协议栈的网络层使用网际协议IP，它是整个协议栈的核心协议，因此在TCP/IP协议栈中网络层常称为网际层。</strong></p>
<h4 id="二网络层提供的两种服务">二、网络层提供的两种服务</h4>
<ul>
<li>面向连接的虚电路服务</li>
</ul>
<p>​ 可靠通信由网络来保证，必须建立网络层的连接——虚电路VC（Virtual
Circuit），通信双方沿着已建立的虚电路发送分组。通信结束后，需要释放之前所建立的虚电路。</p>
<ul>
<li>无连接的数据报服务
<ul>
<li>可靠通信应当由用户主机来保证</li>
<li>不需要建立网络层连接</li>
<li>每个分组可走不同的路径</li>
<li>每个分组的首部必须携带目的主机的完整地址</li>
<li>这种通信方式所传送的分组可能误码、丢失、重复和失序。</li>
<li>由于网络本身不提供端到端的可靠传输服务，这就使网络中的路由器可以做得比较简单，而且价格低廉（与电信网的交换机相比较）。</li>
<li>因特网采用了这种设计思想，也就是将复杂的网络处理功能置于因特网的边缘（用户主机和其内部的运输层），而将相对简单的尽最大努力的分组交付功能置于因特网核心。</li>
</ul></li>
</ul>
<h4 id="三ipv4地址">三、IPV4地址</h4>
<p><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220712145410048.png" /></p>
<p><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220713152341503.png" /></p>
<h4 id="四分类编址的ipv4地址">四、分类编址的IPV4地址：</h4>
<p>​ 划分为ABCDE五类地址，</p>
<p><img src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14 下午1.10.50.png" style="zoom:50%;" /></p>
<p>​ 只有ABC类地址可以分配给主机或路由器。</p>
<ul>
<li>A类地址：
<ul>
<li>最小网络号为0保留不指派</li>
<li>最大网络号127，作为本地回环测试地址，不指派。
<ul>
<li>最小的本地回环测试地址：127.0.0.1</li>
<li>最大的本地回环测试地址：127.255.255.254</li>
</ul></li>
</ul></li>
<li>BC类地址：
<ul>
<li>最小最大网络号均可指派</li>
</ul></li>
</ul>
<p><strong>注意，</strong>一些特殊地址如下所示：</p>
<p><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14%20下午1.17.12.png" /></p>
<h4 id="五划分子网的ipv4地址">五、划分子网的IPV4地址：</h4>
<p>​ 从主机号部分借用一部分作为子网号，来避免主机号的浪费。</p>
<p>​
32比特的子网掩码可以表明分类IP地址的主机号部分被借用了几个比特作为子网号。</p>
<ul>
<li>默认子网掩码：
<ul>
<li>未划分子网的情况下使用的子网掩码</li>
</ul></li>
</ul>
<p><img src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14 下午1.26.26.png" style="zoom: 50%;" /></p>
<h4 id="六无分类编址的ipv4地址">六、无分类编址的IPV4地址：</h4>
<p>​
划分子网在一定程度上缓解了因特网在发展中遇到的困难，但是数量巨大的C类网因为其地址空间太小并没有得到充分使用，而因特网的1P地址仍在加速消耗，整个PV4地址空间面临全部耗尽的威胁。</p>
<p><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14%20下午1.45.27.png" /></p>
<ul>
<li>以192.168.4.0/30为例：</li>
</ul>
<p><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14%20下午1.52.48.png" /></p>
<ul>
<li><p><strong>路由聚合（构造超网）</strong></p>
<ul>
<li>找共同前缀，然后写在网络号部分即可</li>
<li><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14%20下午1.48.49.png" /></li>
<li>聚合地址块：172.1.4.0/22</li>
<li>网络前缀越长，地址块越小，路由越具体；</li>
<li>若路由器查表转发分组时发现有多条由可选，选择网络前缀最长的那条，这称为最长前缀匹配，因为这样的路由更具体。</li>
</ul>
<h4 id="七分配ipv4地址的应用规划">七、分配IPV4地址的应用规划</h4>
<ul>
<li>使用定长的子网掩码分配</li>
<li>使用变长的子网掩码分配</li>
</ul></li>
<li><p>采用定长的子网掩码分配示例：</p></li>
</ul>
<p><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14%20下午2.10.28.png" /></p>
<p><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14%20下午2.13.56.png" /></p>
<p><img src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14 下午2.14.21.png" style="zoom: 50%;" /></p>
<p><strong>最终结果如下：</strong></p>
<figure>
<img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14%20下午2.16.48.png"
alt="截屏2022-07-14 下午2.16.48" />
<figcaption aria-hidden="true">截屏2022-07-14 下午2.16.48</figcaption>
</figure>
<ul>
<li>使用变长的子网掩码分配示例：</li>
</ul>
<p><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14%20下午2.19.31.png" /></p>
<p><strong>最终结果：</strong></p>
<p><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14%20下午2.21.06.png" /></p>
<h4 id="八ip数据包的发送与转发">八、IP数据包的发送与转发</h4>
<ul>
<li>主机如何发送IP数据报</li>
<li>路由器如何发送IP数据报</li>
</ul>
<h5
id="源主机如何知道自己与目的主机不在同一个网络下">1、源主机如何知道自己与目的主机不在同一个网络下？</h5>
<p>其将 主机IP地址和子网掩码作与操作，即可得到网络号，比对即可</p>
<h5
id="源主机如何知道路由器r的存在">2、源主机如何知道路由器R的存在？</h5>
<p>​
用户会为每个主机指定一个路由器，作为转发的路由器，即该主机的<strong>默认网关</strong></p>
<p>​
这样当本网络中的主机要和其他网络中的主机通信时，就交付给默认网关进行转发</p>
<h5
id="路由器收到ip数据报后如何转发">3、路由器收到IP数据报后如何转发？</h5>
<p>检查IP数据报首部是否出错：</p>
<ul>
<li>若出错，则直接丢弃该P数据报并通告源主机。</li>
<li>若没有出错，则进行转发</li>
</ul>
<p>根据数据报的目的地址在路由表中查找匹配的条目：</p>
<ul>
<li><p>若找到匹配的条目，则转发给条目中指示的下一跳</p></li>
<li><p>若找不到，则丢弃该P数据报并通告源主机</p></li>
</ul>
<h5 id="路由表">4、路由表：</h5>
<p><img src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14 下午2.48.32.png" style="zoom:50%;" /></p>
<p><strong>注意：路由器是隔离广播域的，即不会转发广播数据报</strong></p>
<h4
id="九静态路由配置和可能产生的路由环路问题">九、静态路由配置和可能产生的路由环路问题</h4>
<p>​
静态路由配置是指用户或网络管理员使用路由器的相关命令给路由器人工配置路由表。<strong>开销小，但是容易产生错误，仅适用于小型网络</strong></p>
<ul>
<li>默认路由条目：目的网络地址为 0.0.0.0/0</li>
<li>特定主机路由条目：目的网络地址为特定主机的IP地址，子网掩码为255.255.255.255</li>
</ul>
<p><img src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14 下午3.08.12.png" style="zoom: 67%;" /></p>
<h4
id="十动态路由配置路由选择协议概述">十、动态路由配置——路由选择协议概述：</h4>
<p>英特网采用的路由选择协议特点：</p>
<ul>
<li>自适应：路由动态选择，能较好的适应网络状态的变化</li>
<li>分布式：路由器之间交换路由信息</li>
<li>分层次：将整个因特网划分为许多较小的自治系统AS
<ul>
<li>在自治系统内部使用的协议叫做<strong>内部网关协议</strong>，不同自治系统内部可以使用不同的内部网关协议</li>
<li>在自治系统之间使用的协议叫做<strong>外部网关协议</strong></li>
<li><img src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14 下午5.02.09.png" style="zoom:50%;" /></li>
</ul></li>
<li>常见的路由选择协议（在路由器上运行）：</li>
</ul>
<p><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14%20下午5.09.56.png" /></p>
<ul>
<li><p>路由器的基本结构：</p>
<p><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14%20下午5.13.08.png" /></p></li>
</ul>
<p>进入的分组有两种类型：<strong>普通的数据分组 / 路由报文</strong></p>
<ul>
<li><p>普通的数据分组经由转发表转发至对应输出端口</p></li>
<li><p>路由报文进入路由选择处理机，路由选择处理机根据此更新路由表。</p></li>
<li><p>路由选择处理机还会定期的给其他路由器发送路由报文，告知自己知道的路由信息</p></li>
</ul>
<p><img src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14 下午5.14.34.png" style="zoom:50%;" /></p>
<ul>
<li>路由器还有输入和输出缓冲区</li>
</ul>
<p><img src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/mac/截屏2022-07-14 下午5.21.54.png" style="zoom:50%;" /></p>
<h4 id="十一路由信息协议rip">十一、路由信息协议RIP：</h4>
<ul>
<li><p>RIP要求自治系统AS内的每一个路由器<strong>都要维护从它自己到AS内其他每一个网络的距离记录。这是一组距离，称为“距离向量D-V(Distance-.Vector)”</strong></p></li>
<li><p>RIP使用<strong>跳数(Hop
Count)作为度量(Metric)</strong>来衡量到达目的网络的距离。</p>
<ul>
<li>路由器到直连网络的距离定义为1</li>
<li>路由器到非直连网络的距离定义为<strong>所经过的路由器数+1</strong></li>
<li>允许一条路径最多只能包含15个路由器。“距离”等于16时相当于不可达。
因此，<strong>RIP只适用于小型互联网。</strong></li>
</ul></li>
<li><p>RIP认为好的路由就是“距离短”的路由，也就是所通过路由器数量最少的路由。</p></li>
<li><p><strong>三个要点</strong>：</p>
<ul>
<li>1、和谁交换？仅和相邻路由器交换信息</li>
<li>2、交换什么？交换自己的路由表</li>
<li>3、何时交换？周期性交换</li>
</ul></li>
<li><p><strong>基本工作过程</strong>：</p>
<ul>
<li>1、路由器刚开始工作时，只知道自己到直连网络的距离为1。</li>
<li>2、每个路由器<strong>仅和相邻路由器</strong>周期性地交换并更新路由信息。</li>
<li>3、若干次交换和更新后，每个路由器都知道到达本AS内各网络的最短距离和下一跳地址，称为收敛。</li>
<li><img src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715135934147.png" style="zoom:67%;" /></li>
</ul></li>
<li><p><strong>路由条目的更新规则</strong>：</p>
<ul>
<li><p>假设C向D发送封装有路由信息的RIP更新报文</p>
<p><img src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715140223941.png" style="zoom:50%;" /></p></li>
<li><p>路由器D收到报文后，有两个步骤</p>
<ul>
<li>1、更新发来的路由表，具体步骤：将下一跳全部改成C，然后距离增加1</li>
<li><img src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715140524648.png" style="zoom: 67%;" /></li>
<li>2、根据改造后的路由表改造D的路由表：
<ul>
<li>到达目的网络如果下一跳相同，用最新消息更新。</li>
<li>到达目的网络如果下一跳不同，新路由如果有优势则更新，如果等价则添加（负载均衡）。</li>
<li>如果发现新的目的网络，则添加。</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<p><img src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715140751946.png" style="zoom:67%;" /></p>
<ul>
<li>RIP存在问题：
<ul>
<li>坏消息传播的慢—路由环路问题</li>
<li>可行解决方案：
<ul>
<li>限制最大路径距离为15（16表示不可达）</li>
<li>当路由表发生变化时就立即发送更新报文（即“触发更新”），而不仅是周期性发送</li>
<li>让路由器记录收到某特定路由信息的接口，而不让同一路由信息再通过此接口向反方向传送（即“水平分割"）</li>
</ul></li>
</ul></li>
</ul>
<h4
id="十二开放最短路径优先ospf协议">十二、开放最短路径优先OSPF协议：</h4>
<ul>
<li><p>特点：</p>
<ul>
<li><p>不限制网络规模，收敛快。</p></li>
<li><p>基于链路状态</p></li>
<li><p>链路状态是指本路由器都和哪些路由器相邻，以及相应链路的“代价”（cost）。</p>
<ul>
<li>“代价”用来表示费用、距离、时延、带宽，等等。这些都由网络管理人员来决定。）</li>
<li><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715141321395.png"
title="fig:" alt="image-20220715141321395" /></li>
</ul></li>
</ul></li>
<li><p>OSPF相邻路由器之间通过<strong>交互问候分组，建立和维护邻居关系</strong></p>
<ul>
<li>40s未收到来自另据路由器的问候分组，则认为该邻居不可达。</li>
<li>发送周期为10s</li>
<li><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715141512773.png" /></li>
</ul></li>
<li><p>使用OSPF的每个路由器都会产生<strong>链路状态通告LSA（Link State
Advertisement）</strong>。LSA中包含以下内容：</p>
<ul>
<li>直连网络的链路状态信息</li>
<li>邻居路由器的链路状态信息</li>
<li>LSA被封装在<strong>链路状态更新分组LSU中</strong>，采用洪泛法发送。</li>
</ul></li>
<li><p>使用OSPF的每个路由器都有一个<strong>链路状态数据库LSDB，用于存储LSA。</strong>通过各路由器洪泛发送封装有自己LSA的LSU分组，各路由器的LSDB最终将达到一致。</p>
<ul>
<li><img src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715141716322.png" style="zoom:50%;" /></li>
</ul></li>
<li><p>使用OSPF的<strong>各路由器基于LSDB进行最短路径优先SPF计算</strong>，构建出各自到达其他各路由器的最短路径，即构建各自的路由表。</p></li>
</ul>
<p><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715141814166.png" /></p>
<ul>
<li>OSPF的五种分组类型：
<ul>
<li>类型1，<strong>问候（Hello）分组</strong>，用来发现和维护邻居路由器的可达性。</li>
<li>类型2，<strong>数据库描述（Database
Description）分组</strong>，向邻居路由器给出自己的链路状态数据库中的所有链路状态项目的摘要信息</li>
<li>类型3，<strong>链路状态请求（Link State
Request）分组</strong>，向邻居路由器请求发送某些链路状态项目的详细信息。</li>
<li>类型4，<strong>链路状态更新（Link State
Update）分组</strong>，路由器使用这种分组将其链路状态进行洪泛发送，即用洪泛法对全网更新链路状态。</li>
<li>类型5，<strong>链路状态确认（Link State
Acknowledgment）分组</strong>，这是对链路状态更新分组的确认分组。</li>
</ul></li>
<li>OSPF的基本工作过程：
<ul>
<li><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715142215113.png" /></li>
</ul></li>
<li>DR/BDR路由器：
<ul>
<li>在多点接入网络中，</li>
<li>选举<strong>指定路由器DR（designated
router）</strong>和<strong>备用的指定路由器BDR（backup designated
router）</strong></li>
<li>所有的非DR/BDR只与DR/BDR建立邻居关系，非DR/BDR之间通过DR/BDR交换信息</li>
</ul></li>
</ul>
<p><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715142449139.png" /></p>
<ul>
<li><p>为了使OSPF能够用于规模很大的网络，OSPF把一个自治系统再划分为若干个更小的范围，叫做区域（Area）</p>
<ul>
<li><p><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715142704821.png" /></p></li>
<li><p>这样使得链路状态通告仅需要在区域内部进行，减少了网络中的通信量。</p></li>
<li><p><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715142752029.png" /></p></li>
</ul></li>
</ul>
<h4 id="十三边界网关协议bgp">十三、边界网关协议BGP：</h4>
<figure>
<img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715143025813.png"
alt="image-20220715143025813" />
<figcaption aria-hidden="true">image-20220715143025813</figcaption>
</figure>
<p>​
<strong>由于没有统一的度量，所以考虑最佳路由是没有意义的</strong></p>
<p>​
<strong>自治系统之间的路由选择必须考虑相关策略（政治，经济，安全等）</strong></p>
<p>​
<strong>基于上述策略,BGP只能是力求寻找一条能够到达目的网络且比较好的路由（不能兜圈子），而并非要寻找一条最佳路由</strong></p>
<ul>
<li><strong>BGP工作原理：</strong>
<ul>
<li>在配置BGP时，每个自治系统的管理员要选择至少一个路由器作为该自治系统的“BGP发言人”。</li>
<li>不同自治系统的BGP发言人要交换路由信息，首先必须建立TCP连接，端口号为179
<ul>
<li>在此TCP连接上交换BGP报文以建立BGP会话</li>
<li>利用BGP会话交换路由信息（例如，增加新的路由，或撤销过时的路由，以及报告出错的情况等）</li>
<li>使用TCP连接交换路由信息的两个BGP发言人，彼此称为对方的邻站（neighbor）或对等站（peer）</li>
</ul></li>
<li>BGP发言人除了运行BGP外，还必须运行自己所在自治系统所使用的内部网关协议IGP，例如OSPF或RIP。</li>
<li><img src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715143347153.png" style="zoom:67%;" /></li>
<li>当BGP发言人互相交换了网络可达性的信息后，各BGP发言人就根据所采用的策略从收到的路由信息中找出到达各自治系统的较好的路由。也就是构造出树形结构、不存在回路的自治系统连通图。</li>
</ul></li>
<li><strong>BGP的四种报文</strong>：
<ul>
<li>OPEN（打开）报文：用来与相邻的另一个BGP发言人建立关系，使通信初始化</li>
<li>UPDATE（更新）报文：用来通告某一路由的信息，以及列出要撤销的多条路由</li>
<li>KEEPALIVE（保活）报文：用来周期性地证实邻站的连通性。</li>
<li>NOTIFICATION（通知）报文：用来发送检测到的差错。</li>
</ul></li>
</ul>
<h4 id="十四ip数据包的首部格式">十四、IP数据包的首部格式</h4>
<p><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715150218837.png" /></p>
<ul>
<li><p>版本：指IPV4</p></li>
<li><p>首部长度：占4比特，表示IP数据报首部的长度。该字段的取值以4字节为单位。</p></li>
<li><p>可选字段：长度从1个字节到40个字节不等。用来支持排错、测量及安全等措施。</p></li>
<li><p>填充字段：确保首部长度为4字节的整数倍。使用全0进行填充。</p></li>
<li><p>区分服务：占8比特，用来获得更好的服务</p></li>
<li><p>总长度：占16比特，表示IP数据报的总长度（首部+数据载荷）。</p></li>
<li><p>标识、标志、片偏移：用于IP数据报分片</p>
<ul>
<li><p><img src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715151418051.png" style="zoom:67%;" /></p></li>
<li><p>标识：占16比特，属于同一个数据报的各分片数据报应该具有相同的标识。</p></li>
<li><p>标志：占3比特，各比特含义如下：</p>
<ul>
<li>DF位：1表示不允许分片； 0表示允许分片</li>
<li>MF位：1表示“后面还有分片”；0表示“这是最后一个分片”</li>
<li>保留位：必须为0</li>
</ul></li>
<li><p>片偏移：占13比特，指出分片数据报的数据载荷部分偏移其在原数据报的位置有多少个单位。以8个字节为单位</p></li>
</ul></li>
<li><p>分片示例：</p>
<p><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715151832054.png" /></p></li>
</ul>
<p><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715151823233.png" /></p>
<ul>
<li><p>生存时间TTL：占8比特，最初以秒为单位，最大生存周期为255秒；路由器转发IP数据报时，将IP数据报首部中的该字段的值减去IP数据报在本路由器上所耗费的时间，若不为0就转发，否则就丢弃。现在以“跳数”为单位，路由器转发IP数据报时，将IP数据报首部中的该字段的值减1，若不为0就转发，否则就丢弃。</p></li>
<li><p>协议：占8比特，指明IPv4数据报的数据部分是何种协议数据单元。</p></li>
</ul>
<p><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715153014423.png" /></p>
<ul>
<li>首部检验和：占16比特，用来检测首部在传输过程中是否出现差错。比CRC检验码简单，称为因特网检验和。</li>
</ul>
<h4 id="十五网际控制报文协议icmp">十五、网际控制报文协议ICMP</h4>
<p>​
为了更有效地转发IP数据报和提高交付成功的机会，在网际层使用了网际控制报文协议ICMP（Internet
Control Message Protocol）。</p>
<p>​
主机或路由器使用ICMP来发送<strong>差错报告报文和询问报文</strong>。</p>
<p>​ ICMP报文被封装在IP数据报中发送。</p>
<ul>
<li><p><strong>差错报告报文</strong>共以下五种报文：</p>
<ul>
<li>终点不可达：
<ul>
<li>当路由器或主机不能交付数据报时，就向源点发送终点不可达报文。具体可再根据ICMP的代码字段细分为目的网络不可达、目的主机不可达、目的协议不可达、目的端口不可达、目的网络未知、目的主机未知等13种错误。</li>
</ul></li>
<li>源点抑制：
<ul>
<li>当路由器或主机由于拥塞而丢弃数据报时，就向源点发送源点抑制报文，使源点知道应当把数据报的发送速率放慢。</li>
<li><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715153421685.png" /></li>
</ul></li>
<li>时间超过：
<ul>
<li>当路由器收到一个目的IP地址不是自己的IP数据报，会将其生存时间TTL字段的值减1。若结果不为0，则将该IP数据报转发出去；若结果为0，除丢弃该IP数据报外，还要向源点发送时间超过报文。</li>
</ul></li>
<li>参数问题：
<ul>
<li>当路由器或目的主机收到IP数据报后，根据其首部中的检验和字段发现首部在传输过程中出现了误码，就丢弃该数据报，并向源点发送参数问题报文。</li>
</ul></li>
<li>改变路由（重定向）：
<ul>
<li>路由器把改变路由报文发送给主机，让主机知道下次应将数据报发送给另外的路由器（可通过更好的路由）。</li>
<li><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715153600977.png" /></li>
</ul></li>
</ul></li>
<li><p><strong>询问报文</strong>有以下两种：</p>
<ul>
<li>回送请求和回答：
<ul>
<li>ICMP回送请求报文是由主机或路由器向一个特定的目的主机发出的询问。
收到此报文的主机必须给源主机或路由器发送ICMP回送回答报文。这种询问报文用来测试目的站是否可达及了解其有关状态。</li>
</ul></li>
<li>时间戳请求和回答：
<ul>
<li>ICMP时间戳请求报文是请某个主机或路由器回答当前的日期和时间。在ICMP时间戳回答报文中有一个32位的字段，其中写入的整数代表从
1900年1月1日起到当前时刻一共有多少秒。这种询问报文用来进行时钟同步和测量时间。</li>
</ul></li>
</ul></li>
<li><p>应用举例：</p>
<ul>
<li><p>分组网间探测PING：</p>
<ul>
<li>用来测试主机或路由器间的连通性</li>
<li>应用层直接使用网际层的ICMP（没有通过运输层的TCP或UDP）</li>
<li>使用ICMP回送请求和回答报文</li>
</ul></li>
<li><p>跟踪路由traceroute</p>
<ul>
<li><p>用来测试IP数据报从源主机到达目的主机要经过哪些路由器</p></li>
<li><p>Windows版本</p>
<ul>
<li>tracert命令</li>
<li>应用层直接使用网际层ICMP</li>
<li>使用了ICMP回送请求和回答报文以及差错报告报文</li>
</ul></li>
<li><p>Unix版本</p>
<ul>
<li>traceroute命令</li>
<li>在运输层使用UDP协议</li>
<li>仅使用ICMP差错报告报文</li>
</ul></li>
<li><p>原理：</p>
<ul>
<li><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715154351576.png" /></li>
<li><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715154401767.png" /></li>
<li><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715154421381.png" /></li>
<li><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715154432533.png" /></li>
<li>如此循环往复</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<h4 id="十六虚拟专用网vpn">十六、虚拟专用网VPN</h4>
<p>​
<strong>利用公用的因特网作为本机构各专用网之间的通信载体</strong>，这样的专用网又称为虚拟专用网。</p>
<p>​
由于IPv4地址的紧缺，一个机构能够申请到的IPV4地址数量往往远小于本机构所拥有的主机数量。因此，虚拟专用网中的各主机所分配的地址应该是本机构可自由分配的专用地址，而不是需要申请的、在因特网上使用的公有地址。</p>
<p><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715160004940.png" /></p>
<figure>
<img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715160042220.png"
alt="image-20220715160042220" />
<figcaption aria-hidden="true">image-20220715160042220</figcaption>
</figure>
<ul>
<li>如何发送数据报？
<ul>
<li><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715160245145.png" /></li>
</ul></li>
<li>同一机构内不同部门的内部网络所构成的虚拟专用网VPN又称为内联网VPN。</li>
<li>有时一个机构的VPN需要有某些外部机构（通常就是合作伙伴）参加进来。这样的VPN就称为外联网VPN。</li>
<li>在外地工作的员工需要访问公司内部的专用网络时，只要在任何地点接入到因特网，运行驻留在员工PC中的VPN软件，在员工的PC和公司的主机之间建立VPN隧道，即可访问专用网络中的资源。这种VPN称为远程接入VPN。</li>
</ul>
<h4 id="十七网络地址转换nat">十七、网络地址转换NAT</h4>
<p>​
1994年提出了一种网络地址转换NAT的方法再次缓解了IPv4地址空间即将耗尽的问题。</p>
<p>​
NAT能使大量<strong>使用内部专用地址的专用网络用户共享少量外部全球地址</strong>来访问因特网上的主机和资源。</p>
<ul>
<li>发送与接收示意图如下：</li>
</ul>
<p>​ <img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715160540637.png" /></p>
<figure>
<img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715160554747.png"
alt="image-20220715160554747" />
<figcaption aria-hidden="true">image-20220715160554747</figcaption>
</figure>
<p>​
由于绝大多数的网络应用都是使用运输层协议TCP或UDP来传送数据，因此可以利用运输层的端口号和IP地址一起进行转换。这样，用一个全球IP地址就可以使多个拥有本地地址的主机同时和因特网上的主机进行通信。这种将端口号和IP地址一起进行转换的技术叫作<strong>网络地址与端口号转换NAPT（Network
Address and Port Translation）。</strong></p>
<p><img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715160700885.png" /></p>
<p><strong>注意：在通信中，外网主机是不能首先发起通信的，因为NAPT路由器收到来自外网的IP数据报后，在NAPT转换表中找不到相应的记录。故而内网主机不能直接充当因特网服务器</strong></p>
<p><strong>对一些P2P网络应用，需要外网主机主动与内网主机进行通信，在通过NAT
时会遇到问题，需要网络应用自己使用一些特殊的NAT穿越技术来解决问题。</strong></p>
<figure>
<img
src="https://mypic416.oss-cn-hangzhou.aliyuncs.com/windows/image-20220715161612437.png"
alt="image-20220715161612437" />
<figcaption aria-hidden="true">image-20220715161612437</figcaption>
</figure>

    </div>

    
    
    
      
  <div class="popular-posts-header">相关文章</div>
  <ul class="popular-posts">
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\2022\04\27\dcdee696a9ce\" rel="bookmark">计网微课堂Chap1——计网基础知识与概述</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\2022\04\27\70c42ee7d534\" rel="bookmark">计网微课堂Chap1——计网基础知识与概述</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\2022\05\01\81ac33552c19\" rel="bookmark">计网微课堂Chap2——物理层原理</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\2022\07\15\b846bd0fbb3c\" rel="bookmark">计网微课堂Chap5——运输层原理</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\2022\07\17\78c11b2eddea\" rel="bookmark">计网微课堂Chap6——应用层原理</a></div>
    </li>
  </ul>


    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Computer-Network/" rel="tag"># Computer Network</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/05/12/feb80abbdc95/" rel="prev" title="计网微课堂Chap3——数据链路层原理">
                  <i class="fa fa-chevron-left"></i> 计网微课堂Chap3——数据链路层原理
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/07/15/b846bd0fbb3c/" rel="next" title="计网微课堂Chap5——运输层原理">
                  计网微课堂Chap5——运输层原理 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments utterances-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Fantast</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">769k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">35:35</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="utterances" type="application/json">{"enable":true,"repo":"Fantast416/myblog-comment","issue_term":"pathname","theme":"github-light"}</script>
<script src="/js/third-party/comments/utterances.js"></script>

</body>
</html>
